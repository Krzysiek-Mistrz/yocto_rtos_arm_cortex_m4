header:
  version: 11

machine: stm32f411-dk
distro: recovery

local_conf_header:
  multiconfig: |
    BB_CURRENT_MC = "default"
  fetch_threads: |
    # Limit parallel downloads to 4 to prevent network overload
    BB_NUMBER_FETCH_THREADS = "4"
  fetch_robustness: |
    # Work around flaky networks/proxies that break GitHub clones over HTTP/2
    FETCHCMD_git = "git -c http.version=HTTP/1.1 -c gc.autoDetach=false -c core.pager=cat -c safe.bareRepository=all"

    # Make wget more tolerant of slow/unstable links for large tarballs
    FETCHCMD_wget = "/usr/bin/env wget -t 5 -T 300 --retry-connrefused --waitretry=5"

target:
  - zephyr-recovery

repos:
  bitbake:
    url: https://git.openembedded.org/bitbake
    branch: "2.8"
    path: sources/bitbake
    layers:
      .: "disabled"

  openembedded-core:
    url: https://git.openembedded.org/openembedded-core
    branch: scarthgap
    path: sources/openembedded-core
    layers:
      meta:

  meta-openembedded:
    url: https://git.openembedded.org/meta-openembedded
    branch: scarthgap
    path: sources/meta-openembedded
    layers:
      meta-oe:
      meta-python:

  meta-zephyr:
    url: https://git.yoctoproject.org/meta-zephyr
    branch: scarthgap
    path: sources/meta-zephyr
    layers:
      meta-zephyr-core:
      meta-zephyr-bsp:

  meta-arm:
    url: https://git.yoctoproject.org/meta-arm
    branch: scarthgap
    path: sources/meta-arm
    layers:
      meta-arm:
      meta-arm-toolchain:

  meta-mono:
    path: .

  # Zephyr-only extensions (bbappends that expect meta-zephyr to be present)
  meta-mono-zephyr:
    path: meta-mono-zephyr
